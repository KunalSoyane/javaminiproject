<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Online Voting System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .login-container {
            max-width: 450px;
            width: 100%;
        }

        .login-card {
            background-color: #ffffff;
            border: none;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2.5rem;
        }

        .login-card .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #0d6efd;
            margin-bottom: 0.5rem;
            text-align: center;
            text-decoration: none;
        }

        .login-card .logo i {
            margin-right: 8px;
        }

        .login-card .logo:hover {
            color: #0b5ed7;
        }

        .login-card .welcome-text {
            text-align: center;
            color: #6c757d;
            margin-bottom: 2rem;
        }

        .form-control {
            border-radius: 0.5rem;
            padding: 0.8rem 1rem;
            border: 1px solid #dee2e6;
        }

        .form-control:focus {
            border-color: #86b7fe;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }

        .btn-primary {
            background-color: #0d6efd;
            border-color: #0d6efd;
            font-weight: 500;
            padding: 0.8rem;
            border-radius: 0.5rem;
            width: 100%;
            transition: background-color 0.3s;
        }

        .btn-primary:hover {
            background-color: #0b5ed7;
            border-color: #0a58ca;
        }

        /* Role Switcher */
        .role-switcher {
            display: flex;
            border: 1px solid #dee2e6;
            border-radius: 0.5rem;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .role-switcher .btn {
            flex: 1;
            border: none;
            border-radius: 0;
            padding: 0.75rem;
            font-weight: 500;
            transition: background-color 0.3s, color 0.3s;
        }

        .role-switcher .btn.active {
            background-color: #0d6efd;
            color: white;
        }

        .role-switcher .btn:not(.active) {
            background-color: #e9ecef;
            color: #495057;
        }

        #otp-group {
            display: none; /* Hidden by default */
        }
    </style>
</head>
<body>

<div class="login-container">
    <div class="login-card">
        <a href="index.html" class="logo d-block"><i class="bi bi-box-seam-fill"></i>SecureVote</a>
        <p class="welcome-text">Login to cast your vote or manage elections.</p>

        <form id="loginForm" action="register" method="post">
            <div class="role-switcher">
                <button type="button" class="btn active" id="voterBtn">Voter</button>
                <button type="button" class="btn" id="adminBtn">Admin</button>
            </div>

            <div class="mb-3">
                <label for="fullName" class="form-label">Full Name</label>
                <input type="text" class="form-control" id="fullName" placeholder="Enter your full name" required>
            </div>

            <div class="mb-3">
                <label for="phoneNumber" class="form-label">Phone Number</label>
                <input type="tel" class="form-control" id="phoneNumber" placeholder="Enter your 10-digit phone number" required>
            </div>

            <div class="d-grid mb-3">
                <button type="button" class="btn btn-secondary" id="sendOtpBtn">
                    <i class="bi bi-send"></i> Send OTP
                </button>
            </div>

            <div id="otp-group" class="mb-3">
                <label for="otp" class="form-label">Enter OTP</label>
                <input type="text" class="form-control" id="otp" placeholder="Enter 6-digit OTP" required>
                <div class="form-text text-center mt-2">An OTP has been sent to your phone.</div>
            </div>

            <div class="d-grid">
                <button type="submit" class="btn btn-primary" id="loginBtn" disabled>Login</button>
            </div>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const voterBtn = document.getElementById('voterBtn');
        const adminBtn = document.getElementById('adminBtn');
        const sendOtpBtn = document.getElementById('sendOtpBtn');
        const otpGroup = document.getElementById('otp-group');
        const loginBtn = document.getElementById('loginBtn');
        const loginForm = document.getElementById('loginForm');
        const fullNameInput = document.getElementById('fullName');
        const phoneInput = document.getElementById('phoneNumber');
        const otpInput = document.getElementById('otp');

        let selectedRole = 'voter'; // Default role

        // Role switcher logic
        voterBtn.addEventListener('click', () => {
            if (!voterBtn.classList.contains('active')) {
                voterBtn.classList.add('active');
                adminBtn.classList.remove('active');
                selectedRole = 'voter';
            }
        });

        adminBtn.addEventListener('click', () => {
            if (!adminBtn.classList.contains('active')) {
                adminBtn.classList.add('active');
                voterBtn.classList.remove('active');
                selectedRole = 'admin';
            }
        });

        // "Send OTP" button logic
        sendOtpBtn.addEventListener('click', () => {
            if (fullNameInput.value.trim() === '' || phoneInput.value.trim() === '') {
                alert('Please fill in your name and phone number first.');
                return;
            }
            sendOtpBtn.disabled = true;
            sendOtpBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Sending...';
            setTimeout(() => {
                sendOtpBtn.classList.remove('btn-secondary');
                sendOtpBtn.classList.add('btn-success');
                sendOtpBtn.innerHTML = '<i class="bi bi-check-circle-fill"></i> OTP Sent!';
                otpGroup.style.display = 'block';
                loginBtn.disabled = false;
            }, 1500);
        });

        // Form submission logic
        loginForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const otp = otpInput.value;
            if (otp.trim() === '') {
                alert('Please enter the OTP.');
                return;
            }

            loginBtn.disabled = true;
            loginBtn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> Verifying...';

            setTimeout(() => {
                // On successful login, redirect based on role
                if (selectedRole === 'admin') {
                    window.location.href = 'admin.html';
                } else {
                     // Default to voter, redirect to home page
                    window.location.href = 'index.html';
                }
            }, 1500);
        });
    });
</script>
</body>
</html>